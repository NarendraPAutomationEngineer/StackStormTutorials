version: 1.0
description: simple workflow to get result of local action
input:
 - hosts
vars:
 - so: None
 - se: None
tasks:
  RemoteAction:
    action: core.remote
    input:
      cmd: "whoami"
      hosts: <% ctx(hosts) %>
    next:
     - when: <% succeeded() %>
       publish:
         - r: <% result() %>
         - k: <% result().keys() %>
         - v: <% result().values() %>
         - so:  <% ctx(v)[0].stdout %>
     - when: <% failed() %>
       publish:
         - r: <% result() %>
         - k: <% result().keys() %>
         - v: <% result().values() %>
         - se:  <% ctx(v)[0].stderr %>
output: 
 - result: <% ctx(r) %>
 - keys: <% ctx(k) %>
 - values: <% ctx(v)[0] %>
 - stdout: <% ctx(so) %>
 - stderr: <% ctx(se) %>
